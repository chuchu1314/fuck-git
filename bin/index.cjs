#!/usr/bin/env node
"use strict";const w=require("child_process"),u=require("chalk"),v=require("@inquirer/prompts"),C=require("conf"),k="fuck-git",d="1.1.0",p="fuck-git description",x=["git","marge","rebase","add","commit","checkout","branch","stash","diff","push","blame","fetch","merge","origin","pop","pull","reset","status","-m","-b","-D"];class S{constructor(e,t){this._key=e,this.clear(),this.add(t)}add(e){let t=this.ls();Array.isArray(e)?t=[...t,...e]:t=[...t,e],t=[...new Set(t)],this.config.set(this._key,t)}ls(){return this.config.get(this._key)||[]}remove(e){const n=this.ls().filter(i=>i!==e);this.config.set(this._key,n)}clear(){this.config.set(this._key,[])}}S.prototype.config=new C({projectName:"fuck-git"});const y=new S("git-command",x);function L(o,e){let t="";for(let n=0;n<o.length;n++)for(let i=n+1;i<=o.length;i++){const r=o.slice(n,i);e.includes(r)&&r.length>t.length&&(t=r)}return t}function _(o,e){if(!o||!e)return{similarity:0,maxChildStr:""};if(o===e)return{similarity:1,maxChildStr:o};const t=L(o,e);return{similarity:t.length*2/(o.length+e.length),maxChildStr:t}}function b(o,e,t=.1){let n=0,i="",r="";for(const a of o){if(r.length>=a.length)continue;const{similarity:c,maxChildStr:m}=_(e,a);c>=t&&c>n&&(n=c,i=a,r=m)}return{value:i,similarity:n}}function q(o,e){const t=o.join("_"),n=e.join("_");return t===n}function j(){const o=["-v","-V","-version"],e=["-des","-D","-descript","-description"],t=["-h","-H","-help"],n=process.argv.slice(2),i=n[0]||"";if(o.includes(i)){console.log(d);return}if(e.includes(i)){console.log(p);return}if(t.includes(i)){console.log(u.green(k)+`(v${d})`),console.log(p),console.log(`Options: 
 -config add <command>      add command 
 -config remove <command>   remove command 
 -config ls                 show all command`);return}if(n[0]==="-config"){const[,s,l]=n;try{const g=y[s](l||void 0);console.log(">>>>>>>",g)}catch{console.log(u.yellow(s+"is not support now!"))}return}const a=y.ls();console.log(">>>>>>>",n);const c=n.map(s=>{if(s.startsWith("'")&&console.log("引号",s),/^['"].*['"]$/.test(s))return s;const{value:g,similarity:h}=b(a,s);return!h||h===1?s:g}),m=["git"].concat(c);if(q(n,c))f(n);else{console.log(u.yellow("The command have some issues.")),console.log(),console.log(u.green(m.join(" "))),console.log();const s=async()=>{const l=await v.input({message:"Is this the command you want to execute? (yes/no/quit)"});["yes","y"].includes(l.toLocaleLowerCase())?f(c):["no","n"].includes(l.toLocaleLowerCase())?f(n):["quit","q"].includes(l.toLocaleLowerCase())?process.exit(0):(console.log("Please input yes or no."),s())};s()}}function f(o){return new Promise((e,t)=>{w.spawn("git",o,{stdio:"inherit"}).on("close",i=>{console.log("--------------------funny--------------------"),i===0?e(i):i===1&&t(i)})})}j();
